<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CodeBlock</title>

<style>
{
  box-sizing:border-box;
}

body{
  margin:0;
  font-family:'Segoe UI', Arial, sans-serif;
  background:linear-gradient(135deg,#1e1e2f,#252540);
  color:white;
}

.container{
  display:flex;
  height:100vh;
  gap:15px;
  padding:15px;
}

.column{
  flex:1;
  padding:20px;
  border-radius:16px;
  overflow-y:auto;
  backdrop-filter:blur(10px);
}

#left{
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.08);
}

#right{
  background:rgba(255,255,255,0.08);
  border:2px dashed rgba(255,255,255,0.2);
}

.block{
  padding:14px 16px;
  margin-bottom:12px;
  border-radius:14px;
  cursor:grab;
  user-select:none;
  font-weight:600;
  letter-spacing:0.5px;
  transition:0.2s ease;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}

.block:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 18px rgba(0,0,0,0.4);
}

.dragging{
  opacity:0.4;
  transform:scale(0.95);
}

.block:not(.anchor):not(.text-block){
  background:linear-gradient(135deg,#4CAF50,#43A047);
}

.anchor{
  background:linear-gradient(135deg,#9C27B0,#7B1FA2);
}

.anchor-H0{
  background:linear-gradient(135deg,#2196F3,#1565C0);
}

.stack{
  margin-top:10px;
  padding-left:10px;
  border-left:3px solid rgba(255,255,255,0.3);
  min-height:20px;
}

.text-block{
  background:linear-gradient(135deg,#FF9800,#F57C00);
  display:flex;
  align-items:center;
  gap:8px;
}

.text-input{
  padding:6px 8px;
  border-radius:8px;
  border:none;
  outline:none;
  font-size:14px;
  background:rgba(255,255,255,0.15);
  color:white;
  width:90px;
  transition:0.2s;
}

.text-input::placeholder{
  color:rgba(255,255,255,0.6);
}

.text-input:focus{
  background:rgba(255,255,255,0.25);
  width:120px;
}
</style>
</head>

<body>

<div class="container">

  <div id="left" class="column">
    <div class="block" draggable="true">А1</div>
    <div class="block" draggable="true">Б2</div>
    <div class="block" draggable="true">В3</div>

    <div class="block anchor" draggable="true">
        Г4
        <div class="stack"></div>
    </div>

    <div class="block text-block" draggable="true">
        Д5
        <input class="text-input" type="text" placeholder="тест?" disabled>
    </div>
  </div>

  <div id="right" class="column">

      <div class="block anchor anchor-H0">
          Х0
          <div class="stack"></div>
      </div>

  </div>

</div>

<script>
const left = document.getElementById("left");
const right = document.getElementById("right");

let dragged = null;
let fromPalette = false;

document.addEventListener("dragstart", e=>{
  const block = e.target.closest(".block");
  if(!block) return;

  if(e.target.tagName === "INPUT"){
    e.preventDefault();
    return;
  }

  dragged = block;
  fromPalette = left.contains(block);
  block.classList.add("dragging");
});

document.addEventListener("dragend", ()=>{
  if(dragged){
    dragged.classList.remove("dragging");
  }
  dragged = null;
});

right.addEventListener("dragover", e=>{
  e.preventDefault();
});

right.addEventListener("drop", e=>{
  e.preventDefault();
  if(!dragged) return;

  let block;

  if(fromPalette){
    block = dragged.cloneNode(true);
    block.setAttribute("draggable","true");

    const input = block.querySelector("input");
    if(input){
      input.disabled = false;
      input.addEventListener("mousedown", ev=>{
        ev.stopPropagation();
      });
    }

  } else {
    block = dragged;
  }

  block.classList.remove("dragging");

  const container = e.target.closest(".anchor");

  if(container && right.contains(container)){
      const stack = container.querySelector(".stack");
      stack.appendChild(block);
  } else {
      right.appendChild(block);
  }
});

left.addEventListener("dragover", e=>{
  e.preventDefault();
});

left.addEventListener("drop", e=>{
  e.preventDefault();

  if(dragged && !fromPalette){
    dragged.remove();
  }
});
</script>

</body>
</html>
